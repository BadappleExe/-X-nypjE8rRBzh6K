const f=V;(function(s,P){const y=V,w=s();while(!![]){try{const m=-parseInt(y(0x20c))/0x1*(-parseInt(y(0x1e4))/0x2)+-parseInt(y(0x22b))/0x3*(-parseInt(y(0x1bf))/0x4)+-parseInt(y(0x1f1))/0x5+-parseInt(y(0x227))/0x6*(parseInt(y(0x1dc))/0x7)+parseInt(y(0x21d))/0x8+parseInt(y(0x1e1))/0x9+parseInt(y(0x1f4))/0xa;if(m===P)break;else w['push'](w['shift']());}catch(z){w['push'](w['shift']());}}}(t,0x7cc25));const fs=require('fs'),chalk=require('chalk'),luamin=require(f(0x1b0)),binary=require(f(0x1f6)),emulation=require(f(0x20a)),opcodes={};function V(s,P){const w=t();return V=function(m,z){m=m-0x1ac;let Y=w[m];return Y;},V(s,P);}fs[f(0x1e7)]('./obfuscators/moonsec/opcodes')[f(0x1c3)](s=>{const L=f;opcodes[s[L(0x1d0)]('.')[0x0]]=require('./opcodes/'+s);});function createN(s){const v=f;return{'Type':v(0x1e8),'Token':{'Type':v(0x1b9),'LeadingWhite':'\x20','Source':String(s)},'GetFirstToken':()=>{},'GetLastToken':()=>{}};}function t(){const t8=['14713gMGCoX','SubCount','MatchedInstructions','Test','EntryList','GetLastToken','Chunk','AssignmentStat','GetGlobal','DoStat','GetConst','NilLiteral','ayo','Value','Enum','Instructions','replace','1948936ydkiYg','Move','GetFirstToken',']\x20Matched\x20Instruction\x20#','Print','Lhs','Len','Env','BinopExpr','Found','972gsTgLp','Wrap','GetTable','LoadK','3726SZdlby','length','Prototypes','OpName','OpCodes','Inst','StatementList','SetTable','Self','Condition','Type','Token_Op','../../utility/luamin','Stack','VKey','find','Top','splice','Token','PlaceHolder','Create','Number','OpCodeTypes',']\x20No\x20','BreakStat','Parse','RangeList','1868ImfhJv','Base','NumericForStat','VarArg','forEach','IndexExpr','\x20...\x20SuperInstruction?','somthing\x20unsolved','ForPrep',']\x20\x20\x20No\x20Matched\x20Sub-Instruction\x20For\x20#','ForLoop','Body','ParenExpr','magentaBright','InstrPoint','filter','Add','split','LocalVarStat','Mod','Visit','OpCode','ReturnStat','Constants','???','SuperInstruction','exports','Unpack','String','38899ajftYc','Rhs','ffucking','Token_Compound','VarList','3171411ueZLEi','\x20Instruction\x20#','ABx','36EkWHYe','expression','Expression','readdirSync','NumberLiteral','IfStat','CallExprStat','ArgList','Source','VariableExpr','Variable','Interpreter','TableLiteral','4194790CSsBdr','Tokens','WhileStat','8093610cdVBxQ','CompoundStat','../../utility/binary',']\x20\x20\x20Matched\x20Sub-Instruction\x20For\x20#','Return','number','Call','indexOf','Index','OUT','\x20Instruction\x20For\x20#','\x22\x20with\x20key\x20\x22','FunctionArguments','string','ExprList','Name','StatList','push','title','Ident','toUpperCase','log','./emulation','Matched'];t=function(){return t8;};return t();}function createV(s,P){const C=f;return{'Type':C(0x1ed),'Token':{'Type':C(0x207),'LeadingWhite':'','Source':s},'GetFirstToken':P?P[C(0x21f)]:()=>{},'GetLastToken':P?P[C(0x211)]:()=>{}};}function solvebinop(s,P){const k=f;let w=s['Lhs'],m=s[k(0x1dd)],z=s[k(0x1af)]['Source'];if(w[k(0x1ae)]==k(0x1cb))w=w[k(0x1e6)];if(m[k(0x1ae)]=='ParenExpr')m=m['Expression'];if(w[k(0x1ae)]==k(0x225))w=solvebinop(w,P);if(m[k(0x1ae)]==k(0x225))m=solvebinop(m,P);if(w[k(0x1ae)]==k(0x1ed))w=P[w[k(0x1ee)]['Name']];if(m['Type']==k(0x1ed))m=P[m[k(0x1ee)][k(0x203)]];if(w[k(0x1ae)]==k(0x1e8))w=parseInt(w[k(0x1b6)]['Source']);if(m[k(0x1ae)]==k(0x1e8))m=parseInt(m[k(0x1b6)][k(0x1ec)]);if(typeof w=='number'&&typeof m==k(0x1f9))return emulation[k(0x1e5)](w,z,m);else throw'failed';}function find(s,P,w,m){const j=f;w=w||P[j(0x1ef)];for(let Y=0x0;Y<w['length'];Y++){let G=w[Y],E=G['Type'];if(E==j(0x1f3)){let R=G[j(0x1ad)];if(solvebinop(R,{'Enum':s,'VKey':m}))return find(s,P,G[j(0x1ca)][j(0x231)],m);}else{if(E=='AssignmentStat'){if(G[j(0x222)][0x0]['Type']==j(0x1ed)&&G[j(0x222)][0x0]['Variable'][j(0x203)]==j(0x1b2)){let A=G[j(0x1dd)][0x0];switch(G[j(0x1dd)][0x0][j(0x1ae)]){case'NumberLiteral':m=parseInt(A[j(0x1b6)][j(0x1ec)]);continue;case'UnopExpr':m=-m;continue;default:console[j(0x209)](G['Rhs'][0x0][j(0x1ae)]);throw j(0x1de);}}}else E==j(0x1f5)&&(G['Lhs'][j(0x1ae)]==j(0x1ed)&&G['Lhs'][j(0x1ee)]['Name']==j(0x1b2)&&(m=emulation['expression'](m,G[j(0x1df)]['Source'],m)));}}let z=[];for(let D=0x0;D<w['length'];D++){let r=w[D];if(r['Type']==j(0x1bc))continue;if(r[j(0x1ae)]=='AssignmentStat'&&r['Lhs'][0x0][j(0x1ae)]==j(0x1ed)&&r[j(0x222)][0x0][j(0x1ee)][j(0x203)]==j(0x1b2))continue;if(r['Type']==j(0x1f5)&&r[j(0x222)][j(0x1ae)]==j(0x1ed)&&r[j(0x222)][j(0x1ee)][j(0x203)]==j(0x1b2))continue;z[j(0x205)](r);}return z;}function match(s,P,w,m,z){const t1=f;function Y(E,R){const U=V;let A,D,r;A=function(H,u){const e=V;if(H[e(0x1ae)]!=u['Type']){if(u[e(0x1ae)]=='NumberLiteral'&&H[e(0x1ae)]=='UnopExpr')throw e(0x1c6);else return![];}if(H[e(0x1ae)]==e(0x213))return D(H[e(0x1dd)],u['Rhs'])&&D(H['Lhs'],u[e(0x222)]);else{if(H[e(0x1ae)]==e(0x1c4)){let q=!![];return R&&H[e(0x1c0)][e(0x1ee)]!=undefined&&u[e(0x1c0)][e(0x1ae)]==e(0x1ed)&&(q=H[e(0x1c0)]['Variable'][e(0x203)]==u[e(0x1c0)][e(0x1b6)][e(0x1ec)]),q&&A(H[e(0x1c0)],u[e(0x1c0)])&&A(H[e(0x1fc)],u[e(0x1fc)]);}else{if(H[e(0x1ae)]==e(0x1ed))return!![];else{if(H[e(0x1ae)]==e(0x1e8))return H[e(0x1ec)]==u[e(0x1ec)];else{if(H[e(0x1ae)]=='LocalVarStat')return D(H[e(0x202)],u[e(0x202)]);else{if(H[e(0x1ae)]==e(0x1ea)){const B=H[e(0x1e6)],J=u[e(0x1e6)];return A(B[e(0x1c0)],J[e(0x1c0)])&&D(B[e(0x200)]['ArgList'],J[e(0x200)][e(0x1eb)]);}else{if(H[e(0x1ae)]=='CallExpr')return A(H['Base'],u[e(0x1c0)])&&D(H['FunctionArguments']['ArgList'],u['FunctionArguments'][e(0x1eb)]);else{if(H[e(0x1ae)]==e(0x225)){const S=H[e(0x1af)],M=u[e(0x1af)];return S[e(0x1ec)]==M['Source']&&A(H['Rhs'],u[e(0x1dd)])&&A(H['Lhs'],u[e(0x222)]);}else{if(H[e(0x1ae)]==e(0x215))return D(H[e(0x1ca)]['StatementList'],u[e(0x1ca)][e(0x231)]);else{if(H[e(0x1ae)]==e(0x1d5))return D(H[e(0x202)],u['ExprList']);else{if(H['Type']==e(0x217))return!![];else{if(H[e(0x1ae)]==e(0x1f0))return!![];else{if(H[e(0x1ae)]==e(0x1c1))return D(H[e(0x1be)],u[e(0x1be)])&&D(H[e(0x1ca)][e(0x231)],u['Body'][e(0x231)]);else{if(H[e(0x1ae)]==e(0x1cb))return A(H['Expression'],u['Expression']);else{if(H[e(0x1ae)]=='UnopExpr')return H[e(0x1af)][e(0x1ec)]==u[e(0x1af)][e(0x1ec)]&&A(H[e(0x1dd)],u[e(0x1dd)]);else{if(H[e(0x1ae)]==e(0x1e9)){if(!A(H[e(0x1ad)],u[e(0x1ad)]))return![];if(R&&!D(H['Body'][e(0x231)],u[e(0x1ca)][e(0x231)]))return![];return D(H[e(0x1ca)][e(0x231)],u[e(0x1ca)][e(0x231)]);}}}}}}}}}}}}}}}}return console['log'](H),console[e(0x209)](u),![];},D=function(H,u){const F=V;if(H[F(0x22c)]!=u['length'])return![];else{if(H[F(0x22c)]==0x0)return!![];}for(let q=0x0;q<H['length'];q++){if(!A(H[q],u[q]))return![];}return!![];};z&&(E=E['replace'](/local/g,''));E=E['replace'](/OP_A/g,'2')[U(0x21c)](/OP_B/g,'3')[U(0x21c)](/OP_C/g,'4')['replace'](/InstrPoint/g,m[U(0x1cd)])[U(0x21c)](/Upvalues/g,m['Upvalues'])[U(0x21c)](/Unpack/g,m[U(0x1da)])[U(0x21c)](/Wrap/g,m[U(0x228)])[U(0x21c)](/Inst/g,m[U(0x230)])[U(0x21c)](/Top/g,m[U(0x1b4)])['replace'](/Stk/g,m[U(0x1b1)])['replace'](/Env/g,m[U(0x224)]),r=luamin[U(0x1bd)](E);let Z={},h=()=>{};Z[U(0x1c4)]=function(H){const d=U;if(H[d(0x1fc)]['Type']==d(0x1ed)){let u=m['GetConst'](H['Index']['Variable'][d(0x203)]);typeof u==d(0x1f9)&&(H['Index']=createN(u));}h(H);},Z[U(0x225)]=function(H){const x=U;if(H[x(0x222)][x(0x1ae)]==x(0x1ed)){let u=m[x(0x216)](H[x(0x222)][x(0x1ee)][x(0x203)]);typeof u==x(0x1f9)&&(H['Lhs']=createN(u));}if(H[x(0x1dd)]['Type']=='VariableExpr'){let q=m[x(0x216)](H['Rhs'][x(0x1ee)][x(0x203)]);typeof q==x(0x1f9)&&(H['Rhs']=createN(q));}};if(s['length']>0x1&&(s[0x0][U(0x1ae)]==U(0x1d1)&&s[0x0][U(0x202)][U(0x22c)]>0x0&&s[0x0][U(0x202)][0x0][U(0x1ae)]=='TableLiteral'||s[0x0][U(0x1ae)]==U(0x213)&&s[0x0][U(0x1dd)][U(0x22c)]>0x0&&s[0x0]['Rhs'][0x0][U(0x1ae)]==U(0x1f0))){let H,u,q,B;s[0x0]['Type']=='LocalVarStat'?(H=s[0x0][U(0x1e0)][0x0][U(0x1ec)],u=[],q=s[0x0][U(0x202)][0x0],B=q[U(0x210)]):(H=s[0x0]['Lhs'][0x0]['Variable'][U(0x203)],u=[],q=s[0x0][U(0x1dd)][0x0],B=q['EntryList']);for(let S=0x0;S<B[U(0x22c)];S++){let M=B[S],K=M[U(0x219)];K[U(0x1ae)]==U(0x1ed)&&(u[S+0x1]=K[U(0x1ee)][U(0x203)]);}let J=[];for(let l=0x0;l<s[U(0x22c)];l++){s[l]!=s[0x0]&&J[U(0x205)](s[l]);}s=J,h=W=>{const t0=U;if(W[t0(0x1c0)]['Type']==t0(0x1c4)&&W['Base']['Base'][t0(0x1ae)]=='VariableExpr'&&W[t0(0x1c0)][t0(0x1c0)][t0(0x1ee)][t0(0x203)]==H){let p=W[t0(0x1c0)][t0(0x1c0)],n=W['Base'][t0(0x1fc)],o=n[t0(0x1b6)][t0(0x1ec)],I=u[o];W[t0(0x1c0)]=p;}};}return luamin[U(0x1d3)]({'Type':U(0x204),'StatementList':s,'SemicolonList':[]},Z),D(s,r[U(0x231)]);}for(opcode in opcodes){const E=opcodes[opcode];for(v of Object['values'](E)){if(v['Match']!=undefined&&v['Match'](s)||v[t1(0x1db)]!=undefined&&Y(v['String'],v['Thorough'])){P[w]['PC']=w;const R=v[t1(0x1b8)](P[w]);return R[t1(0x1d4)]=binary[t1(0x22f)][t1(0x1fb)](opcode),R[t1(0x22e)]=binary[t1(0x22f)][R['OpCode']],R[t1(0x1ae)]=binary[t1(0x1ba)][R[t1(0x1d4)]],R;}}}function G(A){const t2=t1;if(A['Type']!=t2(0x213))return![];let D=A[t2(0x1dd)][0x0],Z=A['Lhs'][0x0];return Z[t2(0x1ae)]==t2(0x1ed)&&Z[t2(0x1ee)][t2(0x203)]=='PC'&&D[t2(0x1ae)]==t2(0x225)&&D[t2(0x222)]['Type']==t2(0x1ed)&&D[t2(0x222)][t2(0x1ee)][t2(0x203)]=='PC';}if(s[t1(0x1b3)](A=>G(A))){let A=[];s[t1(0x21b)]=[],s['SuperInstruction']=!![],s[t1(0x20e)]=[],s[t1(0x20d)]=s[t1(0x1ce)](D=>G(D))[t1(0x22c)],s[t1(0x21b)][t1(0x205)](A);for(let D=0x0;D<s[t1(0x22c)];D++){const r=s[D];if(G(r)){D++,A=[],s[t1(0x21b)][t1(0x205)](A);continue;}else{if(r[t1(0x1ae)]==t1(0x1d1))continue;else A[t1(0x205)](r);}}for(let Z=0x0;Z<s[t1(0x21b)][t1(0x22c)];Z++){const h=s['Instructions'][Z],H=match(h,P,w+Z,m,!![]);H!=null?(H[t1(0x21a)]=Z,s['MatchedInstructions'][t1(0x205)](H)):s[t1(0x20e)]['push']({'PlaceHolder':!![],'Enum':Z});}return s;}}module[f(0x1d9)]=function(s,P){const t4=f;function w(D){const t3=V,r=D[t3(0x21b)],Z=D['Prototypes'],h=[],H=s[t3(0x1f2)];console[t3(0x209)](),process[t3(0x206)]='0/'+r[t3(0x22c)];for(let u=0x0;u<r[t3(0x22c)];u++){const q=r[u][t3(0x21a)],B=find(q,H);if(B!=null){const J=match(B,r,u,H);if(J!=null){if(J[t3(0x1d8)]){const S=J[t3(0x20e)];console[t3(0x209)]('['+chalk[t3(0x1cc)](t3(0x1fd))+t3(0x1bb)+chalk[t3(0x1cc)](t3(0x20b))+t3(0x1fe)+q+t3(0x1c5)),u+=J[t3(0x20d)];for(let M=0x0;M<S[t3(0x22c)];M++){if(!S[M][t3(0x1b7)])h[t3(0x205)](S[M]),console['log']('['+chalk['magentaBright'](t3(0x1fd))+t3(0x1f7)+(S[M][t3(0x21a)]+0x1)+':\x20'+binary[t3(0x22f)][S[M]['OpCode']][t3(0x208)]());else{let K=J['Instructions'][S[M]['Enum']],l=luamin[t3(0x221)]({'Type':t3(0x204),'StatementList':K,'SemicolonList':[]});console[t3(0x209)](l),console[t3(0x209)]('['+chalk['magentaBright']('OUT')+t3(0x1c8)+(S[M]['Enum']+0x1));throw'ayo';}}}else h[t3(0x205)](J),console[t3(0x209)]('['+chalk[t3(0x1cc)](t3(0x1fd))+t3(0x220)+q+':\x20'+binary[t3(0x22f)][J[t3(0x1d4)]][t3(0x208)]());}else{console['log'](luamin[t3(0x221)]({'Type':t3(0x204),'StatementList':B,'SemicolonList':[]})),console[t3(0x209)]('['+chalk[t3(0x1cc)](t3(0x1fd))+t3(0x1bb)+chalk[t3(0x1cc)](t3(0x20b))+'\x20Instruction\x20#'+q);throw t3(0x218);}}else console[t3(0x209)]('['+chalk[t3(0x1cc)](t3(0x1fd))+t3(0x1bb)+chalk[t3(0x1cc)](t3(0x226))+t3(0x1e2)+q);process[t3(0x206)]=u+'/'+r[t3(0x22c)];}for(let W=0x0;W<Z[t3(0x22c)];W++){Z[W]=w(Z[W]);}return D['Instructions']=h,D;}console[t4(0x209)]();let m=w(s[t4(0x212)]),z=function(D){const t5=t4;for(let r=0x0;r<D[t5(0x21b)][t5(0x22c)];r++){let Z=D[t5(0x21b)][r],h=binary[t5(0x22f)][Z['OpCode']];if(h==t5(0x1c2)){D[t5(0x1c2)]=!![];continue;}}for(let H=0x0;H<D[t5(0x22d)][t5(0x22c)];H++){z(D['Prototypes'][H]);}};z(m);const Y=[t4(0x214),t4(0x229),t4(0x20f),'Jmp',t4(0x1d7),t4(0x214),t4(0x229),'Return','LoadK',t4(0x22a),t4(0x22a),t4(0x223),'LoadK',t4(0x1c7),t4(0x21e),t4(0x214),'GetTable','Self',t4(0x21e),t4(0x21e),t4(0x1fa),t4(0x1ac),t4(0x1fa),'Add','Mod',t4(0x1fa),'Concat',t4(0x1cf),t4(0x1d2),t4(0x1c9),t4(0x214),t4(0x232),t4(0x1f8),t4(0x1f8)],G=[t4(0x214),t4(0x22a),t4(0x22a),'LoadK',t4(0x1fa)];for(let D=0x0;D<m[t4(0x21b)][t4(0x22c)];D++){let r=m[t4(0x21b)][D],Z=binary['OpCodes'][r[t4(0x1d4)]];if(Z==t4(0x214)){let h=m[t4(0x21b)][t4(0x1fb)](r),H=[r];for(let u=0x1;u<Y['length'];u++){let q=m[t4(0x21b)][h+u],B=q&&binary[t4(0x22f)][q[t4(0x1d4)]];B==Y[u]&&H[t4(0x205)](q);}}}let E=![],R;function A(J){const t6=t4;J['A']=0x0,J['B']=0x0,J['C']=0x0,J[t6(0x1d4)]=0x0,J[t6(0x1ae)]='AB';}if(E){let J=function(S){const t7=t4;for(let M=0x0;M<S[t7(0x21b)]['length'];M++){let K=S[t7(0x21b)][M],l=binary[t7(0x22f)][K[t7(0x1d4)]];if(l==t7(0x214)){let W=!![];for(let p=0x1;p<G[t7(0x22c)];p++){let n=S[t7(0x21b)][M+p],b=n&&binary[t7(0x22f)][n[t7(0x1d4)]];b!=G[p]&&(W=![]);}if(W&&S[t7(0x1d6)][K['B']]==R){let o=S[t7(0x1d6)][S[t7(0x21b)][M+0x1]['B']],I=S[t7(0x1d6)][S[t7(0x21b)][M+0x2]['B']],c=S['Constants'][S[t7(0x21b)][M+0x3]['B']];if(typeof o!=t7(0x201)||typeof I!=t7(0x201)||typeof c!='number')continue;let T=emulation['decrypt_constant'](o,c),X=S['Constants'][t7(0x22c)]-0x1,N=S[t7(0x21b)][M+0x4]['A'];console[t7(0x209)]('decrypted\x20constant\x20\x22'+o+t7(0x1ff)+c+'\x22\x20->\x20'+T),S[t7(0x1d6)][X]=T,S[t7(0x21b)]['splice'](M,0x1),S[t7(0x21b)][t7(0x1b5)](M,0x1),S['Instructions'][t7(0x1b5)](M,0x1),S[t7(0x21b)]['splice'](M,0x1),S[t7(0x21b)]['splice'](M,0x1),S[t7(0x21b)]['splice'](M,0x0,{'A':N,'B':X,'OpCode':0x1,'OpName':t7(0x22a),'Type':t7(0x1e3)});}}}for(let g=0x0;g<S[t7(0x21b)][t7(0x22c)];g++){let Q=S[t7(0x21b)][g],O=binary['OpCodes'][Q['OpCode']];O==t7(0x21e)&&Q['A']==0x0&&Q['B']==0x0&&S[t7(0x21b)]['splice'](g,0x1);}for(let a=0x0;a<S[t7(0x22d)]['length'];a++){J(S[t7(0x22d)][a]);}};J(m);}return m;};